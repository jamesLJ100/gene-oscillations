install.packages("hdf5r")
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
conda_list()
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
debugSource("C:/Users/James/PycharmProjects/benchmarking-oscillatory-expression-inference/code/2 - calculate dyngen auc.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("~/.active-rstudio-document")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(weight)
View(weight)
View(weight)
View(weight)
source("~/.active-rstudio-document")
View(weight)
View(weight)
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("~/.active-rstudio-document")
View(weight)
source("~/.active-rstudio-document")
View(weight)
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("~/.active-rstudio-document")
View(weight)
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("~/.active-rstudio-document")
View(weight)
source("~/.active-rstudio-document")
View(q)
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("~/.active-rstudio-document")
View(weight)
View(q)
View(q)
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
View(label_df)
View(label_df)
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
View(merge_cyclum)
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
View(pred_cyclum)
View(weight)
source("C:/Users/James/gene-oscillations/generate_datasets.R")
source("C:/Users/James/gene-oscillations/generate_datasets.R")
View(sim)
sim[["model"]][["feature_network"]]
View(sim[["model"]][["feature_network"]])
View(weight)
View(q)
View(weight)
View(sim)
View(realnet_matrix)
View(realcount_data)
View(q)
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
View(merge_cyclum)
table(feature_net$from[grepl("^Target", feature_net$to)])
feature_net <- sim[["model"]][["feature_network"]]
View(feature_net)
table(feature_net$from[grepl("^Target", feature_net$to)])
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
cycling_targets
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
h
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
osc
View(label_df)
cycling_targets
View(feature_net)
cycling_tfs
View(label_df)
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
View(label_df)
View(feature_net)
cycling_targets
View(label_df)
osc
View(label_df)
source("C:/Users/James/gene-oscillations/evaluate.R")
View(label_df)
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/run_dyngen.R")
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
debugSource("C:/Users/James/gene-oscillations/plotting.R")
debugSource("C:/Users/James/gene-oscillations/plotting.R")
debugSource("C:/Users/James/gene-oscillations/plotting.R")
debugSource("C:/Users/James/gene-oscillations/plotting.R")
View(sim)
feature_net <- sim[["model"]][["feature_network"]]
View(feature_net)
debugSource("C:/Users/James/gene-oscillations/plotting.R")
debugSource("C:/Users/James/gene-oscillations/plotting.R")
feature_net <- sim[["model"]][["feature_network"]]
View(feature_net)
debugSource("C:/Users/James/gene-oscillations/plotting.R")
View(feature_info)
View(target_edges)
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
source("C:/Users/James/gene-oscillations/plotting.R")
debugSource("C:/Users/James/gene-oscillations/generate_datasets.R")
debugSource("C:/Users/James/gene-oscillations/generate_datasets.R")
source("C:/Users/James/gene-oscillations/generate_datasets.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/generate_datasets.R")
source("C:/Users/James/gene-oscillations/generate_datasets.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
source("C:/Users/James/gene-oscillations/evaluate.R")
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
expr_files
weight_file
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
fname
sim_file
View(feature_net)
View(label_df)
View(results)
View(results)
results
View(results)
results[["c1000g204_1"]]
source("C:/Users/James/gene-oscillations/generate_datasets.R")
source("C:/Users/James/gene-oscillations/run_cyclum.R")
debugSource("C:/Users/James/gene-oscillations/evaluate.R")
expr_files
results
source("C:/Users/James/gene-oscillations/evaluate.R")
View(results_df)
source("C:/Users/James/gene-oscillations/evaluate.R")
View(results_df)
source("C:/Users/James/gene-oscillations/evaluate.R")
View(results_summary)
auc <- c(0.7455057, 0.8033067, 0.8353125)
sd(auc) / sqrt(3)
n()
View(results_summary)
View(results_df)
source("C:/Users/James/gene-oscillations/evaluate.R")
View(results_summary)
library(fgsea)
library(msigdbr)
library(dplyr)
library(hdf5r)
library(here)
proj_root <- here::here()
setwd(proj_root)
source(file.path(proj_root, "cyclum_helper.R"))
# load data
hct116_dir <- file.path(proj_root, "data/GSM4286760")
cyclum_dir <- file.path(proj_root, "data/GSM4286760/cyclum")
expr_file   <- file.path(hct116_dir, "HCT116_tpm.h5")
weight_file <- file.path(cyclum_dir, "HCT116_tpm_Cyclum.h5")
cyclum_df <- get_scores(expr_file, weight_file)
# build gene list
library(clusterProfiler)
library(org.Hs.eg.db)
genes_entrez <- bitr(cyclum_df$symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Hs.eg.db")
cyclum_df <- merge(cyclum_df, genes_entrez, by.x = "symbol", by.y = "SYMBOL")
geneList <- cyclum_df$score
names(geneList) <- cyclum_df$ENTREZID
geneList <- sort(geneList, decreasing = TRUE)
geneList <- geneList[geneList > 0]
set.seed(42)
geneList <- geneList + rnorm(length(geneList), mean = 0, sd = 1e-10)
geneList <- sort(geneList, decreasing = TRUE)
# hallmark
hallmark <- msigdbr(species = "Homo sapiens", category = "H") %>%
dplyr::select(gs_name, entrez_gene) %>%
mutate(entrez_gene = as.character(entrez_gene))
pathways <- split(hallmark$entrez_gene, hallmark$gs_name)
# run fgsea
cat("Running fgseaSimple...\n")
gsea_result <- fgseaSimple(pathways  = pathways,
stats     = geneList,
nperm     = 100,
scoreType = "pos")
library(fgsea)
toy_stats <- sort(setNames(rnorm(1000), paste0("gene", 1:1000)), decreasing = TRUE)
toy_pathways <- list(
set1 = paste0("gene", 1:50),
set2 = paste0("gene", 500:550)
)
result <- fgseaSimple(pathways = toy_pathways,
stats    = toy_stats,
nperm    = 100)
library(BiocParallel)
register(SerialParam())  # force single threaded
gsea_result <- fgseaSimple(pathways = pathways,
stats    = geneList,
nperm    = 100,
scoreType = "pos")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
View(hallmark)
debugSource("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
debugSource("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
debugSource("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/test.R")
source("C:/Users/James/gene-oscillations/test.R")
usethis::edit_r_profile()
source("C:/Users/James/gene-oscillations/test.R")
dorothea_hs
View(dorothea_hs)
library(dplyr)
library(knitr)
# Check column names and structure
head(dorothea_hs)
table(dorothea_hs$confidence)  # counts per confidence level
# Example: MYC regulon
dorothea_hs %>%
filter(tf == "MYC") %>%
count(confidence, mor) %>%
kable()
debugSource("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
debugSource("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
View(dorothea_hs)
View(dorothea_term2gene)
debugSource("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
source("C:/Users/James/gene-oscillations/evaluate_HCT116.R")
View(results_df)
View(dorothea_df)
dyngen::list_realnetworks()
list_realnetworks()
source("C:/Users/James/gene-oscillations/Untitled.R")
source("C:/Users/James/gene-oscillations/Untitled.R")
names(realnets)
View(realnets)
View(realnets)
source("C:/Users/James/gene-oscillations/download_HCT116_data.R")
source("C:/Users/James/gene-oscillations/download_HCT116_data.R")
debugSource("C:/Users/James/gene-oscillations/download_HCT116_data.R")
View(gsm)
Meta(gsm
Meta(gsm)
Meta(gsm)
View(gsm)
Table(gsm)
debugSource("C:/Users/James/gene-oscillations/download_HCT116_data.R")
Table(gsm)
gsdm
gsm
getGEOSuppFiles("GSE114186", destdir = "./GSE114186_data/")
getGEOSuppFiles("GSE114186")
source("C:/Users/James/gene-oscillations/download_HCT116_data.R")
source("C:/Users/James/gene-oscillations/download_HCT116_data.R")
source("C:/Users/James/gene-oscillations/download_HCT116_data.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
View(seurat_obj)
dim(X)
dim(celldata)
dim(genedata)
ncol(X)
dim(genedata)
source("C:/Users/James/gene-oscillations/segmentation.R")
head(genedata)
ncol(genedata)
colnames(genedata)
source("C:/Users/James/gene-oscillations/segmentation.R")
dim(X)        # rows = cells, columns = genes
dim(celldata) # should match nrow(X)
dim(genedata) # should match ncol(X)
head(genedata)
dim(genedata)  # should now show rows x 1
# Peek at raw structure before rowname assignment
raw_X <- fread(file.path(data_dir, "GSE114186_mmE95_X.csv.gz"), header = TRUE, nrows = 5)
raw_X[1:5, 1:5]
# Also check - are rownames of X actually cell IDs?
rownames(X)[1:5]
colnames(X)[1:5]
source("C:/Users/James/gene-oscillations/segmentation.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
dim(X_raw)
View(seurat_obj)
View(seurat_obj)
source("C:/Users/James/gene-oscillations/segmentation.R")
source("C:/Users/James/gene-oscillations/segmentation.R")
colnames(celldata)
source("C:/Users/James/gene-oscillations/segmentation.R")
DimPlot(seurat_obj, group.by = "louvain", label = TRUE)
colnames(celldata)
DimPlot(seurat_obj, group.by = "leiden", label = TRUE)
DimPlot(seurat_obj, group.by = "batch", label = TRUE)
DimPlot(seurat_obj, group.by = , label = TRUE)
DimPlot(seurat_obj, group.by = "leiden", label = TRUE)
DimPlot(seurat_obj, group.by = "leiden", label = TRUE)
DimPlot(seurat_obj, group.by = "louvain", label = TRUE)
head(celldata)
table(celldata$leiden)
table(celldata$louvain)
source("C:/Users/James/gene-oscillations/run_scPrisma.R")
